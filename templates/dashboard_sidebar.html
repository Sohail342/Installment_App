<div id="app-sidepanel" class="fixed top-0 left-0 h-screen w-64 bg-gradient-to-b from-violet-100 to-white border-r border-gray-200 shadow-lg z-10 transform transition-transform duration-300 ease-in-out mt-[60px]" x-data="{open: true}" :class="{'translate-x-0': open, '-translate-x-full': !open}">
    <div id="sidepanel-drop" class="fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm z-0 hidden" :class="{'block': open}" @click="open = false"></div>
    <div class="flex flex-col h-full relative">
        <a href="#" id="sidepanel-close" class="absolute -right-10 top-2 text-white bg-violet-600 hover:bg-violet-700 rounded-full p-1 w-8 h-8 flex items-center justify-center shadow-md hidden lg:hidden transition-colors duration-200" @click.prevent="open = false">&times;</a>

        <nav id="app-nav-main" class="flex-grow overflow-y-auto scrollbar-thin scrollbar-thumb-violet-300 scrollbar-track-violet-50">
            <div class="px-4 py-4 border-b border-gray-100">
                <h2 class="text-lg font-semibold text-violet-700 flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                    </svg>
                    Dashboard
                </h2>
            </div>
            <ul class="app-menu space-y-2 px-3 py-4" id="menu-accordion">
                <li class="nav-item">
                    <a class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-violet-100 hover:text-violet-700 transition-colors duration-200 border-l-4 border-transparent hover:border-violet-500 active:border-violet-600 active:bg-violet-100 active:text-violet-700 group" href="{% url 'dashboard:dashboard' %}">
                        <span class="inline-flex items-center justify-center w-8 h-8 mr-3 text-violet-600 group-hover:text-violet-700 group-hover:bg-violet-200 bg-violet-100 rounded-lg transition-colors duration-200">
                            <svg width="1.25em" height="1.25em" viewBox="0 0 16 16" class="bi bi-house-door"
                                fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z" />
                                <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
                            </svg>
                        </span>
                        <span class="font-medium">Overview</span>
                    </a>
                </li>
                {% comment %} <li class="nav-item">
                    <!-- Commented code remains unchanged -->
                </li> {% endcomment %}
                <li class="nav-item">
                    <a class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-violet-100 hover:text-violet-700 transition-colors duration-200 border-l-4 border-transparent hover:border-violet-500 group" href="{% url 'admin:index' %}">
                        <span class="inline-flex items-center justify-center w-8 h-8 mr-3 text-violet-600 group-hover:text-violet-700 group-hover:bg-violet-200 bg-violet-100 rounded-lg transition-colors duration-200">
                            <svg width="1.25em" height="1.25em" viewBox="0 0 16 16" class="bi bi-gear" fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M8.837 1.626c-.246-.835-1.428-.835-1.674 0l-.094.319A1.873 1.873 0 0 1 4.377 3.06l-.292-.16c-.764-.415-1.6.42-1.184 1.185l.159.292a1.873 1.873 0 0 1-1.115 2.692l-.319.094c-.835.246-.835 1.428 0 1.674l.319.094a1.873 1.873 0 0 1 1.115 2.693l-.16.291c-.415.764.42 1.6 1.185 1.184l.292-.159a1.873 1.873 0 0 1 2.692 1.116l.094.318c.246.835 1.428.835 1.674 0l.094-.319a1.873 1.873 0 0 1 2.693-1.115l.291.16c.764.415 1.6-.42 1.184-1.185l-.159-.291a1.873 1.873 0 0 1 1.116-2.693l.318-.094c.835-.246.835-1.428 0-1.674l-.319-.094a1.873 1.873 0 0 1-1.115-2.692l.16-.292c.415-.764-.42-1.6-1.185-1.184l-.291.159A1.873 1.873 0 0 1 8.93 1.945l-.094-.319zm-2.633-.283c.527-1.79 3.065-1.79 3.592 0l.094.319a.873.873 0 0 0 1.255.52l.292-.16c1.64-.892 3.434.901 2.54 2.541l-.159.292a.873.873 0 0 0 .52 1.255l.319.094c1.79.527 1.79 3.065 0 3.592l-.319.094a.873.873 0 0 0-.52 1.255l.16.292c.893 1.64-.902 3.434-2.541 2.54l-.292-.159a.873.873 0 0 0-1.255.52l-.094.319c-.527 1.79-3.065 1.79-3.592 0l-.094-.319a.873.873 0 0 0-1.255-.52l-.292.16c-1.64.893-3.433-.902-2.54-2.541l.159-.292a.873.873 0 0 0-.52-1.255l-.319-.094c-1.79-.527-1.79-3.065 0-3.592l.319-.094a.873.873 0 0 0 .52-1.255l-.16-.292c-.892-1.64.902-3.433 2.541-2.54l.292.159a.873.873 0 0 0 1.255-.52l.094-.319z" />
                                <path fill-rule="evenodd"
                                    d="M8 5.754a2.246 2.246 0 1 0 0 4.492 2.246 2.246 0 0 0 0-4.492zM4.754 8a3.246 3.246 0 1 1 6.492 0 3.246 3.246 0 0 1-6.492 0z" />
                            </svg>
                        </span>
                        <span class="font-medium">Admin Panel</span>
                    </a>
                </li>
                
                <!-- New menu item: Products -->
                <li class="nav-item">
                    <a class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-violet-100 hover:text-violet-700 transition-colors duration-200 border-l-4 border-transparent hover:border-violet-500 group" href="{% url 'products:category_list' %}">
                        <span class="inline-flex items-center justify-center w-8 h-8 mr-3 text-violet-600 group-hover:text-violet-700 group-hover:bg-violet-200 bg-violet-100 rounded-lg transition-colors duration-200">
                            <svg width="1.25em" height="1.25em" viewBox="0 0 16 16" class="bi bi-box" fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5 8 5.961 14.154 3.5 8.186 1.113zM15 4.239l-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923l6.5 2.6zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/>
                            </svg>
                        </span>
                        <span class="font-medium">Products</span>
                    </a>
                </li>
                
                <!-- New menu item: Installments -->
                <li class="nav-item">
                    <a class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-violet-100 hover:text-violet-700 transition-colors duration-200 border-l-4 border-transparent hover:border-violet-500 group" href="{% url 'order:total_bill' %}">
                        <span class="inline-flex items-center justify-center w-8 h-8 mr-3 text-violet-600 group-hover:text-violet-700 group-hover:bg-violet-200 bg-violet-100 rounded-lg transition-colors duration-200">
                            <svg width="1.25em" height="1.25em" viewBox="0 0 16 16" class="bi bi-cash-stack" fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1z"/>
                                <path fill-rule="evenodd" d="M1 4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2H4z"/>
                                <path d="M14 7.5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h12z"/>
                            </svg>
                        </span>
                        <span class="font-medium">Installment Bills</span>
                    </a>
                </li>
            </ul>
        </nav>
        <div class="p-4 border-t border-gray-100">
            <div class="bg-gradient-to-r from-violet-50 to-purple-50 rounded-lg p-4 text-sm text-violet-700 shadow-sm">
                <p class="font-medium flex items-center">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                    </svg>
                    Need help?
                </p>
                <p class="mt-2 text-violet-600">Check our documentation</p>
            </div>
        </div>
    </div>
</div>

<!-- Alpine.js for sidebar toggle functionality -->
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script>
    // Initialize sidebar state based on screen size
    document.addEventListener('alpine:init', () => {
        Alpine.data('sidebarState', () => ({
            open: window.innerWidth >= 1200
        }));
    });
    
    // Make sidebar fixed when page scrolls
    document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.getElementById('app-sidepanel');
        const sidebarHeight = sidebar.offsetHeight;
        const windowHeight = window.innerHeight;
        
        // Ensure sidebar is always visible regardless of scroll position
        window.addEventListener('scroll', function() {
            sidebar.style.top = '60px'; // Keep at fixed position
        });
    });
</script>